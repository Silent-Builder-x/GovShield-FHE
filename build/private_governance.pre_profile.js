function weight(x){ return 2097152 * x.network_depth + 256 * x.total_gates + 256 * x.network_size + x.preprocess_weight;}var pre_profile = { 'code':
{"source_file":"use arcis::*;\n\n#[encrypted]\nmod private_governance {\n    use arcis::*;\n\n    pub struct CurrentTally {\n        // 当前链上累积的加密票数\n        // 0: Yes Votes, 1: No Votes, 2: Abstain\n        pub counts: [u64; 3], \n    }\n\n    pub struct UserVote {\n        // 用户的选择 (1=Yes, 2=No, 3=Abstain)\n        pub choice: u64,\n        // 用户的权重 (Token Balance)\n        pub weight: u64,\n    }\n\n    pub struct UpdateResult {\n        // 更新后的加密票数\n        pub new_counts: [u64; 3],\n    }\n\n    #[instruction]\n    pub fn cast_vote(\n        tally_ctxt: Enc<Shared, CurrentTally>,\n        vote_ctxt: Enc<Shared, UserVote>\n    ) -> Enc<Shared, UpdateResult> {\n        let tally = tally_ctxt.to_arcis();\n        let vote = vote_ctxt.to_arcis();\n        \n        // 使用 Mux (Multiplexer) 将权重分配到对应的桶中\n        // If choice == 1 (Yes), add weight to counts[0]\n        // If choice == 2 (No), add weight to counts[1]\n        // If choice == 3 (Abstain), add weight to counts[2]\n\n        let is_yes = vote.choice == 1;\n        let is_no = vote.choice == 2;\n        let is_abstain = vote.choice == 3;\n\n        // 计算增量\n        let add_yes = if is_yes { vote.weight } else { 0u64 };\n        let add_no = if is_no { vote.weight } else { 0u64 };\n        let add_abs = if is_abstain { vote.weight } else { 0u64 };\n\n        // 同态累加\n        let new_yes = tally.counts[0] + add_yes;\n        let new_no = tally.counts[1] + add_no;\n        let new_abs = tally.counts[2] + add_abs;\n\n        let result = UpdateResult {\n            new_counts: [new_yes, new_no, new_abs],\n        };\n\n        // 返回更新后的加密状态给链上程序\n        tally_ctxt.owner.from_arcis(result)\n    }\n}","code":[{"code":"self.owner","region":"Unknown"},{"code":"self.data","region":"Unknown"},{"code":"Self :: __arcis_inner(self.owner, self.data)","region":"Unknown"},{"code":"let tally = tally_ctxt.to_arcis();","region":{"Known":[{"line":29,"column":8},{"line":29,"column":42}]}},{"code":"let vote = vote_ctxt.to_arcis();","region":{"Known":[{"line":30,"column":8},{"line":30,"column":40}]}},{"code":"let is_yes = vote.choice == 1;","region":{"Known":[{"line":37,"column":8},{"line":37,"column":38}]}},{"code":"let is_no = vote.choice == 2;","region":{"Known":[{"line":38,"column":8},{"line":38,"column":37}]}},{"code":"let is_abstain = vote.choice == 3;","region":{"Known":[{"line":39,"column":8},{"line":39,"column":42}]}},{"code":"is_yes","region":{"Known":[{"line":42,"column":25},{"line":42,"column":31}]}},{"code":"0u64","region":{"Known":[{"line":42,"column":55},{"line":42,"column":59}]}},{"code":"vote.weight","region":{"Known":[{"line":42,"column":34},{"line":42,"column":45}]}},{"code":"let add_yes = if is_yes { vote.weight } else { 0u64 };","region":{"Known":[{"line":42,"column":8},{"line":42,"column":62}]}},{"code":"is_no","region":{"Known":[{"line":43,"column":24},{"line":43,"column":29}]}},{"code":"0u64","region":{"Known":[{"line":43,"column":53},{"line":43,"column":57}]}},{"code":"vote.weight","region":{"Known":[{"line":43,"column":32},{"line":43,"column":43}]}},{"code":"let add_no = if is_no { vote.weight } else { 0u64 };","region":{"Known":[{"line":43,"column":8},{"line":43,"column":60}]}},{"code":"is_abstain","region":{"Known":[{"line":44,"column":25},{"line":44,"column":35}]}},{"code":"0u64","region":{"Known":[{"line":44,"column":59},{"line":44,"column":63}]}},{"code":"vote.weight","region":{"Known":[{"line":44,"column":38},{"line":44,"column":49}]}},{"code":"let add_abs = if is_abstain { vote.weight } else { 0u64 };","region":{"Known":[{"line":44,"column":8},{"line":44,"column":66}]}},{"code":"0","region":{"Known":[{"line":47,"column":35},{"line":47,"column":36}]}},{"code":"let new_yes = tally.counts [0] + add_yes;","region":{"Known":[{"line":47,"column":8},{"line":47,"column":48}]}},{"code":"1","region":{"Known":[{"line":48,"column":34},{"line":48,"column":35}]}},{"code":"let new_no = tally.counts [1] + add_no;","region":{"Known":[{"line":48,"column":8},{"line":48,"column":46}]}},{"code":"2","region":{"Known":[{"line":49,"column":35},{"line":49,"column":36}]}},{"code":"let new_abs = tally.counts [2] + add_abs;","region":{"Known":[{"line":49,"column":8},{"line":49,"column":48}]}},{"code":"new_yes","region":{"Known":[{"line":52,"column":25},{"line":52,"column":32}]}},{"code":"new_no","region":{"Known":[{"line":52,"column":34},{"line":52,"column":40}]}},{"code":"new_abs","region":{"Known":[{"line":52,"column":42},{"line":52,"column":49}]}},{"code":"[new_yes, new_no, new_abs]","region":{"Known":[{"line":52,"column":24},{"line":52,"column":50}]}},{"code":"let result = UpdateResult { new_counts : [new_yes, new_no, new_abs], };","region":{"Known":[{"line":51,"column":8},{"line":53,"column":10}]}},{"code":"result","region":{"Known":[{"line":56,"column":36},{"line":56,"column":42}]}},{"code":"1","region":"Unknown"},{"code":"fn inner < T > (a : T, b : T) -> T { ((a + b) as ArcisField) as T }","region":"Unknown"},{"code":"self","region":"Unknown"},{"code":"other","region":"Unknown"},{"code":"a + b","region":"Unknown"},{"code":"(a + b) as ArcisField","region":"Unknown"},{"code":"((a + b) as ArcisField) as T","region":"Unknown"},{"code":"inner(self, other)","region":"Unknown"},{"code":"self.nonce = self.nonce.wrapping_add(1);","region":"Unknown"},{"code":"self","region":"Unknown"},{"code":"a","region":"Unknown"},{"code":"a","region":"Unknown"},{"code":"self.from_arcis_inner(a)","region":"Unknown"},{"code":"a","region":"Unknown"},{"code":"let phantom = [a; 0];","region":"Unknown"},{"code":"data","region":"Unknown"},{"code":"phantom","region":"Unknown"},{"code":"let data = EncData { data, phantom };","region":"Unknown"},{"code":"owner","region":"Unknown"},{"code":"data","region":"Unknown"},{"code":"Self { owner, data }","region":"Unknown"},{"code":"Enc :: new_inner(self, a, self.from_arcis_inner(a))","region":"Unknown"},{"code":"tally_ctxt.owner.from_arcis(result)","region":{"Known":[{"line":56,"column":8},{"line":56,"column":43}]}}]}
, 'instructions':
{"cast_vote":{"profilees":[{"code_idx":0,"before_size_id":0,"after_size_id":0},{"code_idx":1,"before_size_id":0,"after_size_id":1},{"code_idx":2,"before_size_id":0,"after_size_id":2},{"code_idx":3,"before_size_id":0,"after_size_id":2},{"code_idx":0,"before_size_id":2,"after_size_id":2},{"code_idx":1,"before_size_id":2,"after_size_id":2},{"code_idx":2,"before_size_id":2,"after_size_id":3},{"code_idx":4,"before_size_id":2,"after_size_id":3},{"code_idx":5,"before_size_id":3,"after_size_id":4},{"code_idx":6,"before_size_id":4,"after_size_id":5},{"code_idx":7,"before_size_id":5,"after_size_id":6},{"code_idx":8,"before_size_id":6,"after_size_id":6},{"code_idx":9,"before_size_id":6,"after_size_id":6},{"code_idx":10,"before_size_id":6,"after_size_id":6},{"code_idx":11,"before_size_id":6,"after_size_id":7},{"code_idx":12,"before_size_id":7,"after_size_id":7},{"code_idx":13,"before_size_id":7,"after_size_id":7},{"code_idx":14,"before_size_id":7,"after_size_id":7},{"code_idx":15,"before_size_id":7,"after_size_id":8},{"code_idx":16,"before_size_id":8,"after_size_id":8},{"code_idx":17,"before_size_id":8,"after_size_id":8},{"code_idx":18,"before_size_id":8,"after_size_id":8},{"code_idx":19,"before_size_id":8,"after_size_id":9},{"code_idx":20,"before_size_id":9,"after_size_id":9},{"code_idx":21,"before_size_id":9,"after_size_id":10},{"code_idx":22,"before_size_id":10,"after_size_id":10},{"code_idx":23,"before_size_id":10,"after_size_id":11},{"code_idx":24,"before_size_id":11,"after_size_id":11},{"code_idx":25,"before_size_id":11,"after_size_id":12},{"code_idx":26,"before_size_id":12,"after_size_id":12},{"code_idx":27,"before_size_id":12,"after_size_id":12},{"code_idx":28,"before_size_id":12,"after_size_id":12},{"code_idx":29,"before_size_id":12,"after_size_id":12},{"code_idx":30,"before_size_id":12,"after_size_id":12},{"code_idx":31,"before_size_id":12,"after_size_id":12},{"code_idx":32,"before_size_id":12,"after_size_id":12},{"code_idx":33,"before_size_id":12,"after_size_id":12},{"code_idx":34,"before_size_id":12,"after_size_id":12},{"code_idx":35,"before_size_id":12,"after_size_id":12},{"code_idx":36,"before_size_id":12,"after_size_id":13},{"code_idx":37,"before_size_id":12,"after_size_id":13},{"code_idx":38,"before_size_id":12,"after_size_id":14},{"code_idx":39,"before_size_id":12,"after_size_id":14},{"code_idx":40,"before_size_id":12,"after_size_id":14},{"code_idx":41,"before_size_id":14,"after_size_id":14},{"code_idx":42,"before_size_id":14,"after_size_id":14},{"code_idx":43,"before_size_id":14,"after_size_id":14},{"code_idx":44,"before_size_id":14,"after_size_id":15},{"code_idx":45,"before_size_id":15,"after_size_id":15},{"code_idx":46,"before_size_id":15,"after_size_id":15},{"code_idx":47,"before_size_id":15,"after_size_id":15},{"code_idx":48,"before_size_id":15,"after_size_id":15},{"code_idx":49,"before_size_id":15,"after_size_id":15},{"code_idx":50,"before_size_id":15,"after_size_id":15},{"code_idx":51,"before_size_id":15,"after_size_id":15},{"code_idx":52,"before_size_id":15,"after_size_id":15},{"code_idx":53,"before_size_id":14,"after_size_id":15},{"code_idx":54,"before_size_id":12,"after_size_id":15}]}}
, 'instruction_locations':
{"cast_vote":{"Known":[{"line":24,"column":4},{"line":24,"column":18}]}}
};
